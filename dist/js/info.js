$(function(){var e;e=window.location.href.split("?")[1].split("=")[1],$.ajax({url:"../server/php/list_1.php",type:"post",dataType:"json",data:{id:e}}).then(function(t){var i=t[0];for(var n in console.log(i),i)if(null!=i[n])switch(n){case"img":for(var o=JSON.parse(i.img),a=0;a<o.length;a++)0==a?($('<li class="active"><img src="images/img/'+o[a]+'" alt=""></li>').appendTo($(".info .left ul")),$(".info .left .smallImg img").attr("src","images/img/"+o[a].replace(/.jpg$/g,"x400.jpg").replace(/.png$/g,"x400.png")),$(".info .left .bigArea .bigImg").attr("src","images/img/"+o[a].replace(/.jpg$/g,"x800.jpg").replace(/.png$/g,"x800.png"))):$('<li><img src="images/img/'+o[a]+'" alt=""></li>').appendTo($(".info .left ul"));$(".info .left ul li").on("click",function(){$(this).addClass("active").siblings().removeClass("active"),$(".info .left .smallImg img").attr("src",$(this).find("img").attr("src").replace(/.jpg$/g,"x400.jpg").replace(/.png$/g,"x400.png")),$(".info .left .bigImg").attr("src",$(this).find("img").attr("src").replace(/.jpg$/g,"x800.jpg").replace(/.png$/g,"x800.png"))});break;case"name":$(".info .right h2").text(i.name);break;case"msg":$(".info .right .msg").text(i.msg);break;case"price":$(".info .right .price em").text(i.price);break;case"promotion":$(".info .right .promotion span").html("促&emsp;&emsp;销："),$("<i>赠品</i>").prependTo($(".info .right .promotion .content"));var s=JSON.parse(i.promotion);for(a=0;a<s.length;a++)a==s.length-1?$('<img src="images/img/'+s[a]+'" alt=""><em>x1 </em>').appendTo($(".info .right .promotion .content")):$('<img src="images/img/'+s[a]+'" alt=""><em>x1 +</em>').appendTo($(".info .right .promotion .content"));break;case"evaluation":$(".evaluation_left i").text(JSON.parse(i.evaluation)[0]),$(".evaluation_right i").text(JSON.parse(i.evaluation)[1]);break;case"edition":for($(".info .right .edition span").html("版&emsp;&emsp;本："),a=0;a<JSON.parse(i.edition).length;a++)0==a?$('<p class="active">'+JSON.parse(i.edition)[a]+" <i></i></p>").appendTo($(".edition .content")):$("<p>"+JSON.parse(i.edition)[a]+" <i></i></p>").appendTo($(".edition .content"));break;case"goodsColor":for($(".info .right .goodsColor span").html("商品颜色："),a=0;a<JSON.parse(i.goodsColor).length;a++)0==a?$('<p class="active">'+JSON.parse(i.goodsColor)[a]+" <i></i></p>").appendTo($(".goodsColor .content")):$("<p>"+JSON.parse(i.goodsColor)[a]+" <i></i></p>").appendTo($(".goodsColor .content"));break;case"colorSuit":for($(".info .right .colorSuit span").html("颜色类别："),a=0;a<JSON.parse(i.colorSuit).length;a++)0==a?$('<p class="active">'+JSON.parse(i.colorSuit)[a]+" <i></i></p>").appendTo($(".colorSuit .content")):$("<p>"+JSON.parse(i.colorSuit)[a]+" <i></i></p>").appendTo($(".colorSuit .content"));break;case"ram":for($(".info .right .ram span").html("内存容量："),a=0;a<JSON.parse(i.ram).length;a++)0==a?$('<p class="active">'+JSON.parse(i.ram)[a]+" <i></i></p>").appendTo($(".ram .content")):$("<p>"+JSON.parse(i.ram)[a]+" <i></i></p>").appendTo($(".ram .content"));break;case"method":for($(".info .right .method span").html("购买方式："),a=0;a<JSON.parse(i.method).length;a++)0==a?$('<p class="active">'+JSON.parse(i.method)[a]+" <i></i></p>").appendTo($(".method .content")):$("<p>"+JSON.parse(i.method)[a]+" <i></i></p>").appendTo($(".method .content"));break;case"suit":for($(".info .right .suit span").html("套&emsp;&emsp;装："),a=0;a<JSON.parse(i.suit).length;a++)0==a?$('<p class="active">'+JSON.parse(i.suit)[a].name+' <i></i></p><h3 class="active">'+JSON.parse(i.suit)[a].msg+"</h3>").appendTo($(".suit .content")):$("<p>"+JSON.parse(i.suit)[a].name+" <i></i></p><h3>"+JSON.parse(i.suit)[a].msg+"</h3>").appendTo($(".suit .content"));break;case"num":$(".num strong i").text(i.num)}$(".edition,.goodsColor,.ram,.method,.suit,.colorSuit").find("p").on("click",function(){$(this).addClass("active").siblings().removeClass("active")}),$(".suit p").on("click",function(){$(this).next("h3").addClass("active").siblings("h3").removeClass("active")}),$(".info .num .del").on("click",function(){$(".info .num .count").text($(".info .num .count").text()<=1?1:$(".info .num .count").text()-1)}),$(".info .num .add").on("click",function(){$(".info .num .count").text($(".info .num .count").text()>=Number($(this).next("strong").find("i").text())?$(this).next("strong").find("i").text():1+Number($(".info .num .count").text()))}),$(".addToCart").on("click",function(){var t={id:e,color:$(".info .right .goodsColor .active").text(),suit:$(".info .right .suit p.active").text(),num:$(".info .right .num .count").text()};$.ajax({url:"../server/php/loginStatus.php"}).then(function(e){if(console.log(e),"true"==e)$.ajax({url:"../server/php/cart.php",type:"post",dataType:"json",data:t}).then(function(e){"成功"==e&&(alert("操作成功"),$(".slide_aside ul li").eq(2).find("a span").text(Number($("header .cart span").text())+Number($(".info .right .num .count").text())),$(".cart span").text(Number($("header .cart span").text())+Number($(".info .right .num .count").text())))});else{for(var i=JSON.parse($.cookie("list")||"[]"),n=!0,o=0;o<i.length;o++)i[o].id==t.id&&(i[o].num=Number(t.num)+Number(i[o].num),n=!1);n&&i.push(t),alert("操作成功"),$(".search1 ol li").eq(2).find("span").text(Number($(".search1 ol li").eq(2).find("span").text())+Number($(".info .right .num .count").text())),$(".cart span").text(Number($(".search1 ol li").eq(2).find("span").text())+Number($(".info .right .num .count").text())),$(".slide_aside ul li").eq(2).find("a span").text(Number($(".search1 ol li").eq(2).find("span").text())+Number($(".info .right .num .count").text())),$.cookie("list",JSON.stringify(i))}})})}),$(".smallImg").on("mouseenter",function(){$(".bigArea").show(),$(".smallArea").show(),$(".smallImg").on("mousemove",function(e){var t=e.pageX,i=e.pageY,n=t-$(".smallImg").offset().left-$(".smallArea").width()/2,o=i-$(".smallImg").offset().top-$(".smallArea").height()/2;n=(n=n<=0?0:n)>=$(".smallImg").width()-$(".smallArea").width()?$(".smallImg").width()-$(".smallArea").width():n,o=(o=o<=0?0:o)>=$(".smallImg").height()-$(".smallArea").height()?$(".smallImg").height()-$(".smallArea").height():o,$(".smallArea").css({left:n,top:o}),$(".bigImg").css({left:2*-n,top:2*-o})})}).on("mouseleave",function(){$(".bigArea").hide(),$(".smallArea").hide()}),$(".delivery i").on("click",function(){$(this).siblings(".menu").toggleClass("hide")}),$(".delivery .menu ul li").on("click",function(){$(this).hasClass("active")||$(this).addClass("active").siblings().removeClass("active")}),$(".delivery .menu ol li").on("click",function(){$(".delivery .menu ul li:first").text($(this).text()),$(".delivery i em").text($(this).text()),$(this).parents(".menu").toggleClass("hide")}),$(".details .left dl dd ul li h3").on("click",function(){$(this).toggleClass("toggle"),$(this).siblings().slideToggle()}),$(".details .right .right_menu li").on("click",function(){$(this).addClass("active").siblings().removeClass("active"),$(".details .right dl dt ol li").eq($(this).index()).show().siblings().hide()}),$(".details .right .right_menu li").eq(6).on("mouseenter",function(){$(this).find("img").show(),$(this).find("i").rotate(0,180)}).on("mouseleave",function(){$(this).find("img").hide(),$(this).find("i").rotate(180,0)})});