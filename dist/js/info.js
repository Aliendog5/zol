requirejs(["config"],function(){requirejs(["jquery","jquery-cookie","transform"],function(e){e(function(){var t;requirejs(["header","search","nav1","footer_index","copy","aside"]),t=window.location.href.split("?")[1].split("=")[1],e.ajax({url:"../server/php/list_1.php",type:"post",dataType:"json",data:{id:t}}).then(function(i){var n=i[0];for(var o in n)if(null!=n[o])switch(o){case"img":for(var a=JSON.parse(n.img),s=0;s<a.length;s++)0==s?(e('<li class="active"><img src="images/img/'+a[s]+'" alt=""></li>').appendTo(e(".info .left ul")),e(".info .left .smallImg img").attr("src","images/img/"+a[s].replace(/.jpg$/g,"x400.jpg").replace(/.png$/g,"x400.png")),e(".info .left .bigArea .bigImg").attr("src","images/img/"+a[s].replace(/.jpg$/g,"x800.jpg").replace(/.png$/g,"x800.png"))):e('<li><img src="images/img/'+a[s]+'" alt=""></li>').appendTo(e(".info .left ul"));e(".info .left ul li").on("click",function(){e(this).addClass("active").siblings().removeClass("active"),e(".info .left .smallImg img").attr("src",e(this).find("img").attr("src").replace(/.jpg$/g,"x400.jpg").replace(/.png$/g,"x400.png")),e(".info .left .bigImg").attr("src",e(this).find("img").attr("src").replace(/.jpg$/g,"x800.jpg").replace(/.png$/g,"x800.png"))});break;case"name":e(".info .right h2").text(n.name);break;case"msg":e(".info .right .msg").text(n.msg);break;case"price":e(".info .right .price em").text(n.price);break;case"promotion":e(".info .right .promotion span").html("促&emsp;&emsp;销："),e("<i>赠品</i>").prependTo(e(".info .right .promotion .content"));var r=JSON.parse(n.promotion);for(s=0;s<r.length;s++)s==r.length-1?e('<img src="images/img/'+r[s]+'" alt=""><em>x1 </em>').appendTo(e(".info .right .promotion .content")):e('<img src="images/img/'+r[s]+'" alt=""><em>x1 +</em>').appendTo(e(".info .right .promotion .content"));break;case"evaluation":e(".info .right .evaluation span").html("评&emsp;&emsp;价："),e(".evaluation_left").html("购买评价 <i>"+JSON.parse(n.evaluation)[0]+"</i>"),e(".evaluation_right").html("购买评价 <i>"+JSON.parse(n.evaluation)[1]+"</i>");break;case"edition":for(e(".info .right .edition span").html("版&emsp;&emsp;本："),s=0;s<JSON.parse(n.edition).length;s++)0==s?e('<p class="active">'+JSON.parse(n.edition)[s]+" <i></i></p>").appendTo(e(".edition .content")):e("<p>"+JSON.parse(n.edition)[s]+" <i></i></p>").appendTo(e(".edition .content"));break;case"goodsColor":for(e(".info .right .goodsColor span").html("商品颜色："),s=0;s<JSON.parse(n.goodsColor).length;s++)0==s?e('<p class="active">'+JSON.parse(n.goodsColor)[s]+" <i></i></p>").appendTo(e(".goodsColor .content")):e("<p>"+JSON.parse(n.goodsColor)[s]+" <i></i></p>").appendTo(e(".goodsColor .content"));break;case"colorSuit":for(e(".info .right .colorSuit span").html("颜色类别："),s=0;s<JSON.parse(n.colorSuit).length;s++)0==s?e('<p class="active">'+JSON.parse(n.colorSuit)[s]+" <i></i></p>").appendTo(e(".colorSuit .content")):e("<p>"+JSON.parse(n.colorSuit)[s]+" <i></i></p>").appendTo(e(".colorSuit .content"));break;case"ram":for(e(".info .right .ram span").html("内存容量："),s=0;s<JSON.parse(n.ram).length;s++)0==s?e('<p class="active">'+JSON.parse(n.ram)[s]+" <i></i></p>").appendTo(e(".ram .content")):e("<p>"+JSON.parse(n.ram)[s]+" <i></i></p>").appendTo(e(".ram .content"));break;case"method":for(e(".info .right .method span").html("购买方式："),s=0;s<JSON.parse(n.method).length;s++)0==s?e('<p class="active">'+JSON.parse(n.method)[s]+" <i></i></p>").appendTo(e(".method .content")):e("<p>"+JSON.parse(n.method)[s]+" <i></i></p>").appendTo(e(".method .content"));break;case"suit":for(e(".info .right .suit span").html("套&emsp;&emsp;装："),s=0;s<JSON.parse(n.suit).length;s++)0==s?e('<p class="active">'+JSON.parse(n.suit)[s].name+' <i></i></p><h3 class="active">'+JSON.parse(n.suit)[s].msg+"</h3>").appendTo(e(".suit .content")):e("<p>"+JSON.parse(n.suit)[s].name+" <i></i></p><h3>"+JSON.parse(n.suit)[s].msg+"</h3>").appendTo(e(".suit .content"));break;case"num":e(".num strong i").text(n.num)}e(".edition,.goodsColor,.ram,.method,.suit,.colorSuit").find("p").on("click",function(){e(this).addClass("active").siblings().removeClass("active")}),e(".suit p").on("click",function(){e(this).next("h3").addClass("active").siblings("h3").removeClass("active")}),e(".info .num .del").on("click",function(){e(".info .num .count").text(e(".info .num .count").text()<=1?1:e(".info .num .count").text()-1)}),e(".info .num .add").on("click",function(){e(".info .num .count").text(e(".info .num .count").text()>=Number(e(this).next("strong").find("i").text())?e(this).next("strong").find("i").text():1+Number(e(".info .num .count").text()))}),e(".addToCart").on("click",function(){var i={id:t,color:e(".info .right .goodsColor .active").text(),suit:e(".info .right .suit p.active").text(),num:e(".info .right .num .count").text()};e.ajax({url:"../server/php/loginStatus.php"}).then(function(t){if(console.log(t),"true"==t)e.ajax({url:"../server/php/cart.php",type:"post",dataType:"json",data:i}).then(function(t){"成功"==t&&(alert("操作成功"),e(".slide_aside ul li").eq(2).find("a span").text(Number(e("header .cart span").text())+Number(e(".info .right .num .count").text())),e(".cart span").text(Number(e("header .cart span").text())+Number(e(".info .right .num .count").text())))});else{for(var n=JSON.parse(e.cookie("list")||"[]"),o=!0,a=0;a<n.length;a++)n[a].id==i.id&&(n[a].num=Number(i.num)+Number(n[a].num),o=!1);o&&n.push(i),alert("操作成功"),e(".search1 ol li").eq(2).find("span").text(Number(e(".search1 ol li").eq(2).find("span").text())+Number(e(".info .right .num .count").text())),e(".cart span").text(Number(e(".search1 ol li").eq(2).find("span").text())+Number(e(".info .right .num .count").text())),e(".slide_aside ul li").eq(2).find("a span").text(Number(e(".search1 ol li").eq(2).find("span").text())+Number(e(".info .right .num .count").text())),e.cookie("list",JSON.stringify(n))}})})}),e(".smallImg").on("mouseenter",function(){e(".bigArea").show(),e(".smallArea").show(),e(".smallImg").on("mousemove",function(t){var i=t.pageX,n=t.pageY,o=i-e(".smallImg").offset().left-e(".smallArea").width()/2,a=n-e(".smallImg").offset().top-e(".smallArea").height()/2;o=(o=o<=0?0:o)>=e(".smallImg").width()-e(".smallArea").width()?e(".smallImg").width()-e(".smallArea").width():o,a=(a=a<=0?0:a)>=e(".smallImg").height()-e(".smallArea").height()?e(".smallImg").height()-e(".smallArea").height():a,e(".smallArea").css({left:o,top:a}),e(".bigImg").css({left:2*-o,top:2*-a})})}).on("mouseleave",function(){e(".bigArea").hide(),e(".smallArea").hide()}),e(".delivery i").on("click",function(){e(this).siblings(".menu").toggleClass("hide")}),e(".delivery .menu ul li").on("click",function(){e(this).hasClass("active")||e(this).addClass("active").siblings().removeClass("active")}),e(".delivery .menu ol li").on("click",function(){e(".delivery .menu ul li:first").text(e(this).text()),e(".delivery i em").text(e(this).text()),e(this).parents(".menu").toggleClass("hide")}),e(".details .left dl dd ul li h3").on("click",function(){e(this).toggleClass("toggle"),e(this).siblings().slideToggle()}),e(".details .right .right_menu li").on("click",function(){e(this).addClass("active").siblings().removeClass("active"),e(".details .right dl dt ol li").eq(e(this).index()).show().siblings().hide()}),e(".details .right .right_menu li").eq(6).on("mouseenter",function(){e(this).find("img").show(),e(this).find("i").rotate(0,180)}).on("mouseleave",function(){e(this).find("img").hide(),e(this).find("i").rotate(180,0)})})})});