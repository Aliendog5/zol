requirejs(["config"],function(){requirejs(["jquery","jquery-cookie","transform"],function(t,i,e){t(function(){requirejs(["header"]),t.ajax({url:"../server/php/loginStatus.php"}).then(function(i){if("true"==i)t.ajax({url:"../server/php/cart.php",type:"post",dataType:"json"}).then(function(i){var e=0;t(".price p em").text(i.length);for(var s=i,a=s.length-1;a>=0;a--){t('<tr data-info="'+s[a].cart_id+'" data-id="'+s[a].id+'"><td class="good"><img src="images/img/'+s[a].img_list+'" alt=""><div><a href="#">'+s[a].name+"</a><p>颜色："+s[a].cart_color+"</p><p>  套装："+s[a].cart_suit+'</p></div></td><td class="price">'+s[a].price+'</td><td class="num"><a href="javascript:void(0)">-</a><span>'+s[a].cart_num+'</span><a href="javascript:void(0)">+</a></td><td> --</td><td class="money">'+s[a].cart_num*s[a].price+'</td><td class="caozuo"><a href="javascript:void(0)" class="remove">删除</a></td></tr>').appendTo(t("#tab")),e+=parseInt(s[a].cart_num)*parseInt(s[a].price)}t(".remove").on("click",function(){var i=t(this).parents("tr").data("info");t(this).parents("tr").remove(),t.ajax({url:"../server/php/remove.php",type:"post",dataType:"json",data:{id:i}}),alert("操作成功"),t(".price p em").text(Number(t(".cart span").text())-1),t(".cart span").text(Number(t(".cart span").text())-1);for(var e=0,s=0;s<t(".money").length;s++)e+=parseInt(t(".money").eq(s).text());t(".price p em").text(e),t(".total span em").text(e)}),t(".good").on("click",function(){window.location.href="info.html?id="+t(this).parents("tr").data("id")}),t("#tab .num").find("a:even").on("click",function(){if(t(this).siblings("span").text()>1){t(this).parents("td").siblings(".money").text(t(this).parents("td").siblings(".money").text()-t(this).parents("td").siblings(".price").text());var i=parseInt(t(".price p span i").text())-parseInt(t(this).parents("td").siblings(".price").text());t(".price p span i").text(i),t(".list .total span em").text(i)}t(this).siblings("span").text(t(this).siblings("span").text()<=1?1:t(this).siblings("span").text()-1);var e=t(this).parents("tr").data("info");t.ajax({url:"../server/php/remove.php",type:"post",dataType:"json",data:{id:e,num:t(this).siblings("span").text()}})}),t("#tab .num").find("a:odd").on("click",function(){t(this).siblings("span").text(Number(t(this).siblings("span").text())+1),t(this).parents("td").siblings(".money").text(t(this).parents("td").siblings(".price").text()*t(this).siblings("span").text());var i=parseInt(t(".price p span i").text())+parseInt(t(this).parents("td").siblings(".price").text());t(".price p span i").text(i),t(".list .total span em").text(i);var e=t(this).parents("tr").data("info");t.ajax({url:"../server/php/remove.php",type:"post",dataType:"json",data:{id:e,num:t(this).siblings("span").text()}})}),t(".price p span i").text(e),t(".list .total span em").text(e)});else{var e=JSON.parse(t.cookie("list")||"[]"),s=0;t(".price p em").text(e.length);for(var a=e.length-1;a>=0;a--){t('<tr data-info="" data-id="'+e[a].id+'"><td class="good"><img src="" alt=""><div><a href="#"></a><p>颜色：'+e[a].color+"</p><p>  套装："+e[a].suit+'</p></div></td><td class="price"></td><td class="num"><a href="javascript:void(0)">-</a><span>'+e[a].num+'</span><a href="javascript:void(0)">+</a></td><td> --</td><td class="money"></td><td class="caozuo"><a href="javascript:void(0)" class="remove">删除</a></td></tr>').appendTo(t("#tab")),t.ajax({url:"../server/php/list.php",type:"post",dataType:"json",data:{id:e[a].id}}).then(function(i){t("#tab tr[data-id="+i[0].id+"] .good img").attr("src","images/img/"+i[0].img_list),t("#tab tr[data-id="+i[0].id+"] .good a").text(i[0].name),t("#tab tr[data-id="+i[0].id+"] .price").text(i[0].price),s+=Number(i[0].price)*Number(t("#tab tr[data-id="+i[0].id+"] .num span").text()),t("#tab tr[data-id="+i[0].id+"] .money").text(Number(i[0].price)*Number(t("#tab tr[data-id="+i[0].id+"] .num span").text())),t(".price p span i").text(s),t(".list .total span em").text(s)})}t(".remove").on("click",function(){var i=t(this).parents("tr").data("id");t(this).parents("tr").remove();for(var e=JSON.parse(t.cookie("list")),s=0;s<e.length;s++)e[s].id==i&&e.splice(s,1);alert("操作成功"),t(".cart span").text(e.length),t(".price p em").text(e.length),t.cookie("list",JSON.stringify(e));var a=0;for(s=0;s<t(".money").length;s++)a+=parseInt(t(".money").eq(s).text());t(".price p em").text(a),t(".total span em").text(a)}),t(".good").on("click",function(){window.location.href="info.html?id="+t(this).parents("tr").data("id")}),t("#tab .num").find("a:even").on("click",function(){if(t(this).siblings("span").text()>1){t(this).parents("td").siblings(".money").text(t(this).parents("td").siblings(".money").text()-t(this).parents("td").siblings(".price").text());var i=parseInt(t(".price p span i").text())-parseInt(t(this).parents("td").siblings(".price").text());t(".price p span i").text(i),t(".list .total span em").text(i)}t(this).siblings("span").text(t(this).siblings("span").text()<=1?1:t(this).siblings("span").text()-1);for(var e=JSON.parse(t.cookie("list")),s=0;s<e.length;s++)e[s].id==t(this).parents("tr").data("id")&&(e[s].num=t(this).siblings("span").text());t.cookie("list",JSON.stringify(e))}),t("#tab .num").find("a:odd").on("click",function(){t(this).siblings("span").text(Number(t(this).siblings("span").text())+1),t(this).parents("td").siblings(".money").text(t(this).parents("td").siblings(".price").text()*t(this).siblings("span").text());var i=parseInt(t(".price p span i").text())+parseInt(t(this).parents("td").siblings(".price").text());t(".price p span i").text(i),t(".list .total span em").text(i);for(var e=JSON.parse(t.cookie("list")),s=0;s<e.length;s++)e[s].id==t(this).parents("tr").data("id")&&(e[s].num=t(this).siblings("span").text());t.cookie("list",JSON.stringify(e))})}})})})});