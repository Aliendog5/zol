requirejs(["config"],function(){requirejs(["jquery","jquery-cookie","transform"],function(t,a,i){t(function(){requirejs(["header"]),t.ajax({url:"../server/php/loginStatus.php"}).then(function(a){if("true"==a)t.ajax({url:"../server/php/cart.php",type:"post",dataType:"json"}).then(function(a){var i=0;t(".price p em").text(a.length);for(var s=a,e=s.length-1;e>=0;e--){t('<tr data-info="'+s[e].cart_id+'" data-id="'+s[e].id+'"><td class="good"><img src="images/img/'+s[e].img_list+'" alt=""><div><a href="#">'+s[e].name+"</a><p>颜色："+s[e].cart_color+"</p><p>  套装："+s[e].cart_suit+'</p></div></td><td class="price">'+s[e].price+'</td><td class="num"><a href="javascript:void(0)">-</a><span>'+s[e].cart_num+'</span><a href="javascript:void(0)">+</a></td><td> --</td><td class="money">'+s[e].cart_num*s[e].price+'</td><td class="caozuo"><a href="javascript:void(0)" class="remove">删除</a></td></tr>').appendTo(t("#tab")),i+=parseInt(s[e].cart_num)*parseInt(s[e].price)}t(".remove").on("click",function(){var a=t(this).parents("tr").data("info");t(this).parents("tr").remove(),t.ajax({url:"../server/php/remove.php",type:"post",dataType:"json",data:{id:a}}),alert("操作成功"),t(".price p em").text(Number(t(".cart span").text())-1),t(".cart span").text(Number(t(".cart span").text())-1)}),t(".good").on("click",function(){window.location.href="info.html?id="+t(this).parents("tr").data("id")}),t("#tab .num").find("a:first").on("click",function(){t(this).siblings("span").text(t(this).siblings("span").text()<=1?1:t(this).siblings("span").text()-1);var a=t(this).parents("tr").data("info");t.ajax({url:"../server/php/remove.php",type:"post",dataType:"json",data:{id:a,num:t(this).siblings("span").text()}})}),t("#tab .num").find("a:last").on("click",function(){t(this).siblings("span").text(Number(t(this).siblings("span").text())+1);var a=t(this).parents("tr").data("info");t.ajax({url:"../server/php/remove.php",type:"post",dataType:"json",data:{id:a,num:t(this).siblings("span").text()}})}),t(".price p span i").text(i),t(".list .total span").text("￥"+i)});else{var i=JSON.parse(t.cookie("list")||"[]"),s=0;t(".price p em").text(i.length);for(var e=i.length-1;e>=0;e--){t('<tr data-info="" data-id="'+i[e].id+'"><td class="good"><img src="" alt=""><div><a href="#"></a><p>颜色：'+i[e].color+"</p><p>  套装："+i[e].suit+'</p></div></td><td class="price"></td><td class="num"><a href="javascript:void(0)">-</a><span>'+i[e].num+'</span><a href="javascript:void(0)">+</a></td><td> --</td><td class="money"></td><td class="caozuo"><a href="javascript:void(0)" class="remove">删除</a></td></tr>').appendTo(t("#tab")),t.ajax({url:"../server/php/list.php",type:"post",dataType:"json",data:{id:i[e].id}}).then(function(a){t("#tab tr[data-id="+a[0].id+"] .good img").attr("src","images/img/"+a[0].img_list),t("#tab tr[data-id="+a[0].id+"] .good a").text(a[0].name),t("#tab tr[data-id="+a[0].id+"] .price").text(a[0].price),s+=Number(a[0].price)*Number(t("#tab tr[data-id="+a[0].id+"] .num span").text()),t("#tab tr[data-id="+a[0].id+"] .money").text(Number(a[0].price)*Number(t("#tab tr[data-id="+a[0].id+"] .num span").text())),t(".price p span i").text(s),t(".list .total span").text("￥"+s)})}t(".remove").on("click",function(){var a=t(this).parents("tr").data("id");t(this).parents("tr").remove();for(var i=JSON.parse(t.cookie("list")),s=0;s<i.length;s++)i[s].id==a&&i.splice(s,1);alert("操作成功"),t(".cart span").text(i.length),t(".price p em").text(i.length),t.cookie("list",JSON.stringify(i))}),t(".good").on("click",function(){window.location.href="info.html?id="+t(this).parents("tr").data("id")}),t("#tab .num").find("a").eq(0).on("click",function(){t(this).siblings("span").text(t(this).siblings("span").text()<=1?1:t(this).siblings("span").text()-1);for(var a=JSON.parse(t.cookie("list")),i=0;i<a.length;i++)a[i].id==t(this).parents("tr").data("id")&&(a[i].num=t(this).siblings("span").text());t.cookie("list",JSON.stringify(a))}),t("#tab .num").find("a").eq(1).on("click",function(){t(this).siblings("span").text(Number(t(this).siblings("span").text())+1);for(var a=JSON.parse(t.cookie("list")),i=0;i<a.length;i++)a[i].id==t(this).parents("tr").data("id")&&(a[i].num=t(this).siblings("span").text());t.cookie("list",JSON.stringify(a))})}})})})});